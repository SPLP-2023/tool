<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lightning Protection Engineers Reporting Tool</title>
    <link rel="manifest" href="/tool/manifest.json">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/SP%20Bolt%20400x400.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/SP%20Bolt%20400x400.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/tool/icons/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/tool/icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/tool/icons/apple-touch-icon-152x152.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="StrikeR">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>
    <div class="container">
    <div class="nav-header">
    <button class="nav-button back-button" onclick="location.href='reports.html'">
        ← Back to Reports
    </button>
    <button class="nav-button" onclick="location.href='tools.html'">
        Tools
    </button>
</div>
        <h1>Test & Inspection Report</h1>
        
        <!-- Basic Information Section -->
        <div class="section">
            <h2>Site Information</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="siteAddress">Site Address:</label>
                    <textarea id="siteAddress" rows="3" placeholder="Enter full site address..."></textarea>
                </div>
                <div class="form-group">
                    <label for="testDate">Date:</label>
                    <input type="date" id="testDate">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="engineerName">Engineer Name:</label>
                    <input type="text" id="engineerName" placeholder="Enter engineer name...">
                </div>
                <div class="form-group">
                    <label for="testKitRef">Test Kit Reference:</label>
                    <input type="text" id="testKitRef" placeholder="Enter test kit reference...">
                </div>
            </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="jobReference">Job Reference:</label>
                        <input type="text" id="jobReference" placeholder="Enter job reference...">
                    </div>
                    <div class="form-group">
                        <label for="siteStaffName">Site Staff Name:</label>
                        <input type="text" id="siteStaffName" placeholder="Enter site staff name...">
                    </div>
                </div>    

                <!-- Site Staff Signature Section -->
                <div class="form-group">
                    <label for="siteStaffSignature">Site Staff Signature:</label>
                    <div class="signature-container">
                        <canvas id="siteStaffSignatureCanvas" width="300" height="120"></canvas>
                        <div class="signature-controls">
                            <button type="button" id="clearSiteStaffSignature" class="signature-btn clear-btn">Clear</button>
                            <button type="button" id="saveSiteStaffSignature" class="signature-btn save-btn">Save</button>
                        </div>
                        <div id="siteStaffSignatureStatus" class="signature-status">Please sign above</div>
                    </div>
                </div>
            
            <div class="form-group">
                <label for="buildingImage">Building Image (Cover Page):</label>
                <div class="image-upload" onclick="document.getElementById('buildingImageFile').click()">
                    <input type="file" id="buildingImageFile" accept="image/*" class="hidden-file-input" aria-label="Upload building image for cover page" onchange="handleImageUpload(this, 'buildingImagePreview')">
                    <div id="buildingImagePreview">Click to upload building image</div>
                </div>
            </div>
        </div>

              <!-- Replace your entire Standards Selection & Failures section with this -->
        <div class="section">
            <h2>Standard Selection & Failures</h2>
            <div class="form-group standards-dropdown">
                <label for="standard">Select Standard:</label>
                <select id="standard" title="Select lightning protection standard" onchange="updateFailuresList()">
                    <option value="">Select a standard...</option>
                    <option value="BS EN 62305">BS EN 62305 (Current Standard)</option>
                    <option value="BS 6651">BS 6651 (Legacy Standard)</option>
                    <option value="CP 326">CP 326 (Historical Standard)</option>
                    <option value="NF C 17-102">NF C 17-102:2011 (ESE Systems)</option>
                </select>
            </div>
            <div id="failuresContainer" class="hidden">
                <label>Available Failures for Selected Standard:</label>
                <div id="failuresList" class="failures-list"></div>
            </div>
        </div>

        <div class="section">
            <h2>⚠ Selected Failures & Comments</h2>
            <div id="selectedFailures"></div>
        </div>


        <!-- Recommendations Section -->
        <div class="section">
            <h2>Recommendations</h2>
            <div class="form-group">
                <label for="generalComments">Additional Comments:</label>
                <textarea id="generalComments" rows="4" placeholder="Enter any additional observations, recommendations, or general comments about the lightning protection system..."></textarea>
            </div>
        </div>

        <!-- Structure Details Section -->
        <div class="form-section">
            <h2>Structure Details</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="structureHeight">1. Structure Height (m):</label>
                    <input type="number" id="structureHeight" placeholder="Enter height in meters...">
                </div>
                <div class="form-group">
                    <label for="structurePerimeter">2. Structure Perimeter (m):</label>
                    <input type="number" id="structurePerimeter" placeholder="Enter perimeter in meters...">
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label>3. Ground Type:</label>
                    <div id="groundTypeList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Tarmac', this)">Tarmac</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Concrete', this)">Concrete</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Grass', this)">Grass</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Soil', this)">Soil</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Slabs', this)">Slabs</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Block Paving', this)">Block Paving</div>
                        <div class="failure-option" onclick="selectSystemDetail('groundType', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="groundTypeOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('groundType', this.value)">
                </div>
        
                <div class="form-group">
                    <label>4. Boundary Type:</label>
                    <div id="boundaryTypeList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Bricks', this)">Bricks</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Render', this)">Render</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Metal Clad', this)">Metal Clad</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Wooden Clad', this)">Wooden Clad</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Composite Clad', this)">Composite Clad</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Glazing', this)">Glazing</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Stone Blocks', this)">Stone Blocks</div>
                        <div class="failure-option" onclick="selectSystemDetail('boundaryType', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="boundaryTypeOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('boundaryType', this.value)">
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label>5. Roof Type:</label>
                    <div id="roofTypeList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Felt', this)">Felt</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Membrane', this)">Membrane</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Metal Clad', this)">Metal Clad</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Tiles', this)">Tiles</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Lead', this)">Lead</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Seedum', this)">Seedum</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Thatch', this)">Thatch</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Concrete', this)">Concrete</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Asphalt', this)">Asphalt</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofType', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="roofTypeOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('roofType', this.value)">
                </div>
        
                <div class="form-group">
                    <label>6. Roof Layout:</label>
                    <div id="roofLayoutList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Pitched', this)">Pitched</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Sloped', this)">Sloped</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Dome', this)">Dome</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Flat', this)">Flat</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Complex', this)">Complex</div>
                        <div class="failure-option" onclick="selectSystemDetail('roofLayout', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="roofLayoutOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('roofLayout', this.value)">
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label for="structureUse">7. Structure Use:</label>
                    <select id="structureUse">
                        <option value="">Select structure use...</option>
                        <option value="Airport building">Airport building</option>
                        <option value="Base station">Base station</option>
                        <option value="Block of flats">Block of flats</option>
                        <option value="Cathedral">Cathedral</option>
                        <option value="Church">Church</option>
                        <option value="Civic building">Civic building</option>
                        <option value="Commercial/office block">Commercial/office block</option>
                        <option value="Community centre">Community centre</option>
                        <option value="Departmental store">Departmental store</option>
                        <option value="Factory">Factory</option>
                        <option value="Farm building">Farm building</option>
                        <option value="Fuel/service station">Fuel/service station</option>
                        <option value="Gas compound">Gas compound</option>
                        <option value="Halls of residence">Halls of residence</option>
                        <option value="Hospital">Hospital</option>
                        <option value="Hotel">Hotel</option>
                        <option value="Industrial warehouse">Industrial warehouse</option>
                        <option value="Large house">Large house</option>
                        <option value="Leisure centre">Leisure centre</option>
                        <option value="Medical centre">Medical centre</option>
                        <option value="Museum">Museum</option>
                        <option value="Oil refinery/chemical plant">Oil refinery/chemical plant</option>
                        <option value="Old persons/children's home">Old persons/children's home</option>
                        <option value="Police/fire/ambulance station">Police/fire/ambulance station</option>
                        <option value="Power station">Power station</option>
                        <option value="Prison">Prison</option>
                        <option value="Railway station">Railway station</option>
                        <option value="Ruin">Ruin</option>
                        <option value="School">School</option>
                        <option value="Shops/shopping centre">Shops/shopping centre</option>
                        <option value="Sports stadium">Sports stadium</option>
                        <option value="Substation">Substation</option>
                        <option value="Telephone exchange">Telephone exchange</option>
                        <option value="Theatre">Theatre</option>
                        <option value="University">University</option>
                        <option value="Water treatment works">Water treatment works</option>
                        <option value="Wind farm">Wind farm</option>
                    </select>
                </div>
        
                <div class="form-group">
                    <label for="structureOccupancy">8. Structure Maximum Occupancy:</label>
                    <input type="number" id="structureOccupancy" placeholder="Enter maximum occupancy...">
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label for="structureAge">9. Age of Structure (years):</label>
                    <input type="number" id="structureAge" placeholder="Enter age in years...">
                </div>
        
                <div class="form-group">
                    <label for="previousInspections">10. Records of Previous Inspections:</label>
                    <select id="previousInspections">
                        <option value="">Select option...</option>
                        <option value="Yes">Yes</option>
                        <option value="Yes - Digital">Yes - Digital</option>
                        <option value="No">No</option>
                        <option value="N/a">N/a</option>
                    </select>
                </div>
            </div>
        </div>
        <!-- System Details Section -->
        <div class="form-section">
            <h2>System Details</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label>1. Air Termination Network (can select multiple):</label>
                    <div id="airTerminationList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'Faraday Cage Grid Mesh', this)">Faraday Cage Grid Mesh</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'Conductive Metal Sheet Roof', this)">Conductive Metal Sheet Roof</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'Conductive Metal Cappings', this)">Conductive Metal Cappings</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'Finial Rods', this)">Finial Rods</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'ESEAT', this)">ESEAT</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'HVI', this)">HVI</div>
                        <div class="failure-option" onclick="selectSystemDetail('airTermination', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="airTerminationOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('airTermination', this.value)">
                </div>
        
                <div class="form-group">
                    <label>2. Conductors & Fixings (can select multiple):</label>
                    <div id="airConductorsList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'NMDC', this)">NMDC</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Self-Adhesive', this)">Self-Adhesive</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Heat Weldable', this)">Heat Weldable</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Slate Hold-Fast', this)">Slate Hold-Fast</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Felt Pad', this)">Felt Pad</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Membrane Pad', this)">Membrane Pad</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Aluminium', this)">Aluminium</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Copper', this)">Copper</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Metal Sheet Roof', this)">Metal Sheet Roof</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', '25x3mm Bare', this)">25x3mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', '25x3mm PVC', this)">25x3mm PVC</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', '20x3mm Bare', this)">20x3mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', '8mm Bare', this)">8mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', '8mm PVC', this)">8mm PVC</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Black', this)">Black</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Brown', this)">Brown</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Grey', this)">Grey</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Stone', this)">Stone</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'White', this)">White</div>
                        <div class="failure-option" onclick="selectSystemDetail('airConductors', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="airConductorsOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('airConductors', this.value)">
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label>3. Down Conductor Network (can select multiple):</label>
                    <div id="downConductorNetworkList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('downConductorNetwork', 'External Conductors', this)">External Conductors</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductorNetwork', 'Cavity Conductors', this)">Cavity Conductors</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductorNetwork', 'Internal Framework', this)">Internal Framework</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductorNetwork', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="downConductorNetworkOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('downConductorNetwork', this.value)">
                </div>
        
                <div class="form-group">
                    <label>4. Conductors & Fixings (can select multiple):</label>
                    <div id="downConductorsList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'NMDC', this)">NMDC</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Steel Frame', this)">Steel Frame</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Reinforcing Steel Bars', this)">Reinforcing Steel Bars</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Aluminium', this)">Aluminium</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Copper', this)">Copper</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', '25x3mm Bare', this)">25x3mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', '25x3mm PVC', this)">25x3mm PVC</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', '20x3mm Bare', this)">20x3mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', '8mm Bare', this)">8mm Bare</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', '8mm PVC', this)">8mm PVC</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Black', this)">Black</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Brown', this)">Brown</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Grey', this)">Grey</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Stone', this)">Stone</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'White', this)">White</div>
                        <div class="failure-option" onclick="selectSystemDetail('downConductors', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="downConductorsOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('downConductors', this.value)">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>5. Earth Termination Network (can select multiple):</label>
                    <div id="earthTerminationList" class="failures-list">
                        <div class="failure-option" onclick="selectSystemDetail('earthTermination', 'Earth Rods', this)">Earth Rods</div>
                        <div class="failure-option" onclick="selectSystemDetail('earthTermination', 'Earth Matts', this)">Earth Matts</div>
                        <div class="failure-option" onclick="selectSystemDetail('earthTermination', 'Reinforcing', this)">Reinforcing</div>
                        <div class="failure-option" onclick="selectSystemDetail('earthTermination', 'Unknown', this)">Unknown</div>
                        <div class="failure-option" onclick="selectSystemDetail('earthTermination', 'Other', this, true)">Other</div>
                    </div>
                    <input type="text" id="earthTerminationOther" class="hidden" placeholder="Please specify..." onchange="updateOtherValue('earthTermination', this.value)">
                </div>
        
                <div class="form-group">
                    <label for="earthArrangement">6. Earth Arrangement:</label>
                    <select id="earthArrangement">
                        <option value="">Select arrangement...</option>
                        <option value="Type-A">Type-A</option>
                        <option value="Type-B">Type-B</option>
                        <option value="Unknown">Unknown</option>
                    </select>
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label for="mainEquipotentialBond">7. Main Equipotential Bond:</label>
                    <select id="mainEquipotentialBond">
                        <option value="">Select status...</option>
                        <option value="Present">Present</option>
                        <option value="Unidentified">Unidentified</option>
                        <option value="N/a">N/a</option>
                    </select>
                </div>
        
                <div class="form-group">
                    <label for="surgeInstalled">8. Surge Protection Installation:</label>
                    <select id="surgeInstalled">
                        <option value="">Select status...</option>
                        <option value="No SPD located">No SPD located</option>
                        <option value="SPD Located">SPD Located</option>
                        <option value="Requires Further Investigations">Requires Further Investigations</option>
                    </select>
                </div>
            </div>
        
            <div class="form-row">
                <div class="form-group">
                    <label for="surgeType">9. Surge Protection Type:</label>
                    <select id="surgeType">
                        <option value="">Select type...</option>
                        <option value="Type-1">Type-1</option>
                        <option value="Type-2">Type-2</option>
                        <option value="Type-3">Type-3</option>
                        <option value="Combined Unit">Combined Unit</option>
                        <option value="Unidentified">Unidentified</option>
                    </select>
                </div>
        
                <div class="form-group">
                    <label for="surgeSafe">10. Surge Protection Status:</label>
                    <select id="surgeSafe">
                        <option value="">Select status...</option>
                        <option value="Safe">Safe</option>
                        <option value="Fault">Fault</option>
                        <option value="Requires Further Investigations">Requires Further Investigations</option>
                    </select>
                </div>
            </div>
        </div>
        
<!-- Earth Resistance Testing -->
<div class="section">
    <h2>Earth Resistance Test</h2>
    <div class="form-group">
        <label for="numEarths">Number of Earths Tested:</label>
        <input type="number" id="numEarths" min="0" max="100" onchange="generateEarthTable()">
    </div>
    
    <!-- Enhanced Earth Table -->
    <div id="earthTableContainer" class="earth-table-container hidden">
        <div class="table-responsive">
            <table id="earthTable" class="earth-table">
                <thead>
                    <tr>
                        <th>E</th>
                        <th>Ω</th>
                        <th>Test Clamp</th>
                        <th>Pit Type</th>
                        <th>Test Type</th>
                        <th>Ground Type</th>
                        <th>Earth Type</th>
                        <th>Comment</th>
                    </tr>
                </thead>
                <tbody id="earthTableBody">
                    <!-- Rows will be generated dynamically -->
                </tbody>
            </table>
        </div>
        
        <!-- Overall Resistance Display -->
        <div id="earthResult" class="result-display">
            <h4>Overall Earth Resistance:</h4>
            <div id="overallResistance" class="overall-resistance-value">-</div>
        </div>
    </div>
    
    <div class="form-group">
        <label for="earthImages">Inspection Images:</label>
        <div class="image-upload" onclick="document.getElementById('earthImagesFile').click()">
            <input type="file" id="earthImagesFile" accept="image/*" multiple class="hidden-file-input" aria-label="Upload earth test images" onchange="handleMultipleImageUpload(this, 'earthImagesPreview')">
            <div id="earthImagesPreview">Click to upload earth test images</div>
        </div>
    </div>
</div>

        <!-- Final Comments Section -->
        <div class="section">
            <h2>Final Summary Comments</h2>
            <div class="form-group">
                <label for="finalComments">Summary & Recommendations:</label>
                <textarea id="finalComments" rows="4" placeholder="Enter final summary, conclusions, and recommendations for the lightning protection system..."></textarea>
            </div>
        </div>

        <!-- Generate Report Button -->
        <button id="generateReport" onclick="generatePDF()">Generate PDF Report</button>
    </div>
    <style>
     /* Compact Touch Signature Styles */
        .signature-container {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 10px;
            background: #f8f9fa;
        }

        #signatureCanvas {
            border: 2px solid #007bff;
            border-radius: 5px;
            background: white;
            cursor: crosshair;
            width: 100%;
            max-width: 300px;
            height: 120px;
            display: block;
            margin: 0 auto;
            touch-action: none;
        }

        .signature-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .signature-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .clear-btn {
            background-color: #dc3545;
            color: white;
        }

        .clear-btn:hover {
            background-color: #c82333;
        }

        .save-btn {
            background-color: #28a745;
            color: white;
        }

        .save-btn:hover {
            background-color: #218838;
        }

        .signature-status {
            text-align: center;
            margin-top: 8px;
            font-size: 12px;
            color: #6c757d;
        }

        .signature-status.saved {
            color: #28a745;
            font-weight: bold;
        }
        </style>
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Our JavaScript Files -->
    <script src="js/exif.js"></script>
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/auto-save.js"></script>
    <script src="js/touch-signature.js"></script>
    <script src="js/t&i-pdf-generator.js"></script>
    <script>   
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/tool/service-worker.js', {
            scope: '/tool/'
          }).then(registration => {
            console.log('SW registered:', registration.scope);
          }).catch(error => {
            console.log('SW registration failed:', error);
          });
        }
    </script>
    <script>
        // Initialize T&I Report specific components
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize recommendations button
            const addBtn = document.getElementById('addRecommendation');
            if (addBtn) {
                addBtn.addEventListener('click', addRecommendation);
            }    
        
        // Initialize site staff signature
            if (document.getElementById('siteStaffSignatureCanvas')) {
                const siteStaffSignature = new TouchSignature(
                    'siteStaffSignatureCanvas',
                    'clearSiteStaffSignature',
                    'saveSiteStaffSignature',
                    'siteStaffSignatureStatus'
                );
        
                // Store reference for auto-save access
                window.siteStaffSignature = siteStaffSignature;
            }
        });
    </script>
</body>
</html>
